<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FX Risk Management Dashboard</title>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #f9fafb;
        }
        .dashboard-container {
            display: flex;
            height: 100vh;
        }
        .control-panel {
            width: 320px;
            background: white;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 24px;
            overflow-y: auto;
        }
        .main-dashboard {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }
        .control-section {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }
        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e5e7eb;
            outline: none;
            margin-bottom: 8px;
        }
        .excel-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            margin-bottom: 24px;
        }
        .excel-table th, .excel-table td {
            border: 1px solid #d1d5db;
            padding: 8px;
            text-align: right;
        }
        .excel-table th {
            background-color: #f3f4f6;
            font-weight: 600;
        }
        .excel-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .negative {
            color: #dc2626;
        }
        .var-section {
            background-color: #eff6ff;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 24px;
        }
        .var-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        .var-card {
            background: white;
            padding: 16px;
            border-radius: 4px;
            border: 1px solid #d1d5db;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Left Control Panel -->
        <div class="control-panel">
            <h2>FX Risk Controls</h2>
            
            <div class="control-section">
                <h3 style="color: #1d4ed8;">Payment Terms</h3>
                <div style="margin-bottom: 16px;">
                    <label>AP Payment Days: <span id="ap-days">30</span></label>
                    <input type="range" min="15" max="90" step="5" value="30" class="slider" id="ap-slider">
                </div>
                <div>
                    <label>AR Collection Days: <span id="ar-days">45</span></label>
                    <input type="range" min="15" max="75" step="5" value="45" class="slider" id="ar-slider">
                </div>
            </div>

            <div class="control-section">
                <h3 style="color: #059669;">Hedging Strategy</h3>
                <div>
                    <label>Hedge Ratio: <span id="hedge-ratio">0</span>%</label>
                    <input type="range" min="0" max="100" step="5" value="0" class="slider" id="hedge-slider">
                </div>
            </div>

            <div class="control-section">
                <h3 style="color: #7c3aed;">Market Scenarios</h3>
                <div style="margin-bottom: 16px;">
                    <label>USD/MXN Rate: <span id="usd-rate">20.0</span></label>
                    <input type="range" min="15" max="25" step="0.1" value="20.0" class="slider" id="rate-slider">
                </div>
                <div style="margin-bottom: 16px;">
                    <label>Volatility: <span id="volatility">19.5</span>%</label>
                    <input type="range" min="10" max="35" step="0.5" value="19.5" class="slider" id="vol-slider">
                </div>
                <div>
                    <label>Confidence Level:</label>
                    <select id="confidence" style="width: 100%; padding: 8px; margin-top: 8px;">
                        <option value="90">90%</option>
                        <option value="95" selected>95%</option>
                        <option value="99">99%</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div class="main-dashboard">
            <h1>FX Risk Management Dashboard</h1>
            
            <!-- VaR Report Section -->
            <div class="var-section">
                <h2 style="color: #1e3a8a;">FX Management Financial Statement Impact - Mexico</h2>
                <div class="var-grid">
                    <div class="var-card">
                        <div style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">Variable Contribution Margin Exposure</div>
                        <div style="font-size: 24px; font-weight: bold; color: #dc2626;" id="vcm-exposure">-1,704,744</div>
                        <div style="font-size: 12px; color: #6b7280; margin-top: 8px;">P&L Value at Risk</div>
                        <div style="font-size: 18px; font-weight: bold; color: #ea580c;" id="pl-var">157,839</div>
                    </div>
                    <div class="var-card">
                        <div style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">Unrealized FX Exposure</div>
                        <div style="font-size: 24px; font-weight: bold; color: #2563eb;" id="fx-exposure">25,197</div>
                        <div style="font-size: 12px; color: #6b7280; margin-top: 8px;">B/S Value at Risk</div>
                        <div style="font-size: 18px; font-weight: bold; color: #16a34a;" id="bs-var">2,330</div>
                    </div>
                </div>
            </div>

            <!-- Operational Strategy Table -->
            <div style="background: #eff6ff; padding: 12px; margin-bottom: 2px;">
                <h3>Operational Strategy</h3>
            </div>
            <table class="excel-table">
                <thead>
                    <tr>
                        <th style="text-align: left;">Item</th>
                        <th>12mo Forecast</th>
                        <th>Jan-25</th>
                        <th>Feb-25</th>
                        <th>Mar-25</th>
                        <th>Apr-25</th>
                        <th>May-25</th>
                        <th>Jun-25</th>
                        <th>Jul-25</th>
                        <th>Aug-25</th>
                        <th>Sep-25</th>
                        <th>Oct-25</th>
                        <th>Nov-25</th>
                        <th>Dec-25</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: left;">Contractual Sales</td>
                        <td>35,225</td>
                        <td>3,378</td>
                        <td>5,304</td>
                        <td>2,517</td>
                        <td>2,482</td>
                        <td>2,693</td>
                        <td>2,693</td>
                        <td>2,693</td>
                        <td>2,693</td>
                        <td>2,693</td>
                        <td>2,693</td>
                        <td>2,693</td>
                        <td>2,693</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">IC Sales</td>
                        <td>618,455</td>
                        <td>67,891</td>
                        <td>63,857</td>
                        <td>71,648</td>
                        <td>75,454</td>
                        <td>51,738</td>
                        <td>53,601</td>
                        <td>48,031</td>
                        <td>35,015</td>
                        <td>39,632</td>
                        <td>42,662</td>
                        <td>35,488</td>
                        <td>33,438</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Forecasted Purchases</td>
                        <td class="negative">-522,343</td>
                        <td class="negative">-62,086</td>
                        <td class="negative">-55,911</td>
                        <td class="negative">-59,751</td>
                        <td class="negative">-45,981</td>
                        <td class="negative">-44,855</td>
                        <td class="negative">-41,355</td>
                        <td class="negative">-35,296</td>
                        <td class="negative">-35,412</td>
                        <td class="negative">-35,122</td>
                        <td class="negative">-36,711</td>
                        <td class="negative">-35,919</td>
                        <td class="negative">-33,944</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Variable Contribution Margin</td>
                        <td class="negative" id="vcm-annual">-1,704,744</td>
                        <td class="negative" id="vcm-jan">-134,787</td>
                        <td class="negative" id="vcm-feb">-149,520</td>
                        <td class="negative" id="vcm-mar">-149,133</td>
                        <td class="negative" id="vcm-apr">-83,022</td>
                        <td class="negative" id="vcm-may">-129,761</td>
                        <td class="negative" id="vcm-jun">-142,962</td>
                        <td class="negative" id="vcm-jul">-153,345</td>
                        <td class="negative" id="vcm-aug">-160,064</td>
                        <td class="negative" id="vcm-sep">-153,574</td>
                        <td class="negative" id="vcm-oct">-152,322</td>
                        <td class="negative" id="vcm-nov">-150,709</td>
                        <td class="negative" id="vcm-dec">-145,545</td>
                    </tr>
                </tbody>
            </table>

            <!-- Balance Sheet Management Table -->
            <div style="background: #f0fdf4; padding: 12px; margin-bottom: 2px;">
                <h3>Balance Sheet Management</h3>
            </div>
            <table class="excel-table">
                <thead>
                    <tr>
                        <th style="text-align: left;">Item</th>
                        <th>Current Position</th>
                        <th>Jan-25</th>
                        <th>Feb-25</th>
                        <th>Mar-25</th>
                        <th>Apr-25</th>
                        <th>May-25</th>
                        <th>Jun-25</th>
                        <th>Jul-25</th>
                        <th>Aug-25</th>
                        <th>Sep-25</th>
                        <th>Oct-25</th>
                        <th>Nov-25</th>
                        <th>Dec-25</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: left;">Position to impact FX Losses</td>
                        <td id="fx-current">25,197</td>
                        <td id="fx-jan">2,824</td>
                        <td class="negative" id="fx-feb">-48,455</td>
                        <td class="negative" id="fx-mar">-43,255</td>
                        <td class="negative" id="fx-apr">-30,013</td>
                        <td class="negative" id="fx-may">-17,000</td>
                        <td class="negative" id="fx-jun">-8,224</td>
                        <td id="fx-jul">1,206</td>
                        <td id="fx-aug">6,674</td>
                        <td id="fx-sep">9,830</td>
                        <td id="fx-oct">11,887</td>
                        <td id="fx-nov">12,482</td>
                        <td id="fx-dec">17,271</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Position Exposed on EBITDA</td>
                        <td id="ebitda-current">25,197</td>
                        <td id="ebitda-jan">2,824</td>
                        <td class="negative" id="ebitda-feb">-48,455</td>
                        <td class="negative" id="ebitda-mar">-43,255</td>
                        <td class="negative" id="ebitda-apr">-30,013</td>
                        <td class="negative" id="ebitda-may">-17,000</td>
                        <td class="negative" id="ebitda-jun">-8,224</td>
                        <td id="ebitda-jul">1,206</td>
                        <td id="ebitda-aug">6,674</td>
                        <td id="ebitda-sep">9,830</td>
                        <td id="ebitda-oct">11,887</td>
                        <td id="ebitda-nov">12,482</td>
                        <td id="ebitda-dec">17,271</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Baseline data
        const baselineData = {
            vcm: [-1704744, -134787, -149520, -149133, -83022, -129761, -142962, -153345, -160064, -153574, -152322, -150709, -145545],
            fx: [25197, 2824, -48455, -43255, -30013, -17000, -8224, 1206, 6674, 9830, 11887, 12482, 17271]
        };

        // Control elements
        const apSlider = document.getElementById('ap-slider');
        const arSlider = document.getElementById('ar-slider');
        const hedgeSlider = document.getElementById('hedge-slider');
        const rateSlider = document.getElementById('rate-slider');
        const volSlider = document.getElementById('vol-slider');
        const confidenceSelect = document.getElementById('confidence');

        // Update displays
        function updateDisplays() {
            document.getElementById('ap-days').textContent = apSlider.value;
            document.getElementById('ar-days').textContent = arSlider.value;
            document.getElementById('hedge-ratio').textContent = hedgeSlider.value;
            document.getElementById('usd-rate').textContent = parseFloat(rateSlider.value).toFixed(2);
            document.getElementById('volatility').textContent = volSlider.value;
        }

        // Calculate adjustments
        function calculateAdjustments() {
            const apImpact = (30 - parseInt(apSlider.value)) / 30 * 0.15;
            const arImpact = (45 - parseInt(arSlider.value)) / 45 * 0.2;
            const hedgeImpact = parseInt(hedgeSlider.value) / 100;
            const rateImpact = (parseFloat(rateSlider.value) - 20.0) / 20.0;

            // Update VCM values
            baselineData.vcm.forEach((val, index) => {
                const adjusted = val * (1 + apImpact + arImpact + rateImpact) * (1 - hedgeImpact);
                const elementId = index === 0 ? 'vcm-annual' : `vcm-${['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'][index-1]}`;
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = Math.round(adjusted).toLocaleString();
                }
            });

            // Update FX values
            baselineData.fx.forEach((val, index) => {
                const adjusted = val * (1 + apImpact + arImpact + rateImpact) * (1 - hedgeImpact);
                const fxElementId = index === 0 ? 'fx-current' : `fx-${['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'][index-1]}`;
                const ebitdaElementId = index === 0 ? 'ebitda-current' : `ebitda-${['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'][index-1]}`;
                
                const fxElement = document.getElementById(fxElementId);
                const ebitdaElement = document.getElementById(ebitdaElementId);
                
                if (fxElement) fxElement.textContent = Math.round(adjusted).toLocaleString();
                if (ebitdaElement) ebitdaElement.textContent = Math.round(adjusted).toLocaleString();
            });

            // Update VaR calculations
            const volatility = parseFloat(volSlider.value) / 100;
            const confidence = parseInt(confidenceSelect.value);
            const confidenceMultiplier = confidence === 95 ? 1.645 : confidence === 99 ? 2.326 : 1.282;
            const timeHorizon = Math.sqrt(1/12);

            const vcmExposure = baselineData.vcm[0] * (1 + apImpact + arImpact + rateImpact) * (1 - hedgeImpact);
            const plVar = Math.abs(vcmExposure) * volatility * timeHorizon * confidenceMultiplier;
            
            const fxExposure = baselineData.fx[0] * (1 + apImpact + arImpact + rateImpact) * (1 - hedgeImpact);
            const bsVar = Math.abs(fxExposure) * volatility * timeHorizon * confidenceMultiplier;

            document.getElementById('vcm-exposure').textContent = Math.round(vcmExposure).toLocaleString();
            document.getElementById('pl-var').textContent = Math.round(plVar).toLocaleString();
            document.getElementById('fx-exposure').textContent = Math.round(fxExposure).toLocaleString();
            document.getElementById('bs-var').textContent = Math.round(bsVar).toLocaleString();
        }

        // Event listeners
        [apSlider, arSlider, hedgeSlider, rateSlider, volSlider].forEach(slider => {
            slider.addEventListener('input', () => {
                updateDisplays();
                calculateAdjustments();
            });
        });

        confidenceSelect.addEventListener('change', calculateAdjustments);

        // Initialize
        updateDisplays();
        calculateAdjustments();
    </script>
</body>
</html>
